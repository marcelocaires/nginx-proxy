services:
  nginx-proxy:
    image: nginx:latest
    container_name: nginx-reverse-proxy
    
    # Expõe APENAS a porta 443 (HTTPS)
    ports:
      - "443:443"
      # A porta 80 NÃO está mapeada, liberando-a na sua máquina host.

    volumes:
      # Monta o arquivo de configuração do Nginx (com a porta 443)
      - ./nginx.conf:/etc/nginx/conf.d/default.conf:ro
      
      # Monta o diretório 'certs' contendo os certificados do Let's Encrypt
      - ./certs:/etc/nginx/certs:ro 

    # Permite que o contêiner Nginx acesse os backends (4000, 8080, 8081) 
    # rodando na máquina host da OCI através do nome 'host.docker.internal'
    extra_hosts:
      - "host.docker.internal:host-gateway"
      
    restart: always